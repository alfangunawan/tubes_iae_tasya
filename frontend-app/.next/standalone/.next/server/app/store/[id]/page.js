(()=>{var e={};e.id=901,e.ids=[901],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},7310:e=>{"use strict";e.exports=require("url")},2218:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>g,originalPathname:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>c});var r=t(7096),a=t(6132),i=t(7284),l=t.n(i),n=t(2564),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);t.d(s,o);let c=["",{children:["store",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,7573)),"C:\\Users\\alfan\\OneDrive\\Documents\\Data Kuliah\\Tasyakki\\tugas_IAE\\tubes\\tubes_iae\\frontend-app\\src\\app\\store\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,4847)),"C:\\Users\\alfan\\OneDrive\\Documents\\Data Kuliah\\Tasyakki\\tugas_IAE\\tubes\\tubes_iae\\frontend-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,9291,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\alfan\\OneDrive\\Documents\\Data Kuliah\\Tasyakki\\tugas_IAE\\tubes\\tubes_iae\\frontend-app\\src\\app\\store\\[id]\\page.tsx"],m="/store/[id]/page",g={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/store/[id]/page",pathname:"/store/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},6309:(e,s,t)=>{Promise.resolve().then(t.bind(t,3713))},3713:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>StoreDetailPage});var r=t(784),a=t(3701),i=t(7932),l=t(7094),n=t(3699),o=t(7371),c=t(9885),d=t(7114),m=t(9941);async function fetchStore(e){let s=`
    query GetStore($id: ID!) {
      store(id: $id) {
        id
        name
        description
        address
        rating
        reviewCount
        images
        ownerId
        services {
          type
          price
          label
        }
        createdAt
      }
    }
  `,t=await fetch("http://localhost:3000/graphql-store",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:s,variables:{id:e}})}),{data:r,errors:a}=await t.json();if(a)throw Error(a[0].message);return r.store}function StoreDetailPage({params:e}){let{id:s}=e,t=(0,d.useRouter)(),[g,x]=(0,c.useState)(null),[p,u]=(0,c.useState)(!0),[h,b]=(0,c.useState)(""),[f,j]=(0,c.useState)(""),[v,y]=(0,c.useState)(1),[N,w]=(0,c.useState)(null);(0,c.useEffect)(()=>{fetchStore(s).then(e=>{x(e),e.services&&e.services.length>0&&w(e.services[0])}).catch(e=>b(e.message)).finally(()=>u(!1))},[s]);let handleBooking=async()=>{let e;let s=localStorage.getItem("token");if(!s){m.Am.error("Please login to book"),t.push("/login");return}if(!N||!f){m.Am.warning("Please select a date and service");return}try{e=JSON.parse(atob(s.split(".")[1]))}catch(e){m.Am.error("Invalid session. Please login again."),t.push("/login");return}let r=`
            mutation CreateBooking($input: CreateBookingInput!) {
                createBooking(input: $input) {
                    id
                    status
                    totalPrice
                }
            }
        `;try{let a=await fetch("http://localhost:3000/graphql-booking",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({query:r,variables:{input:{userId:e.id,userName:e.name,userEmail:e.email,storeId:g.id,storeName:g.name,serviceType:N.type,serviceLabel:N.label,weight:v,pricePerKg:N.price,checkInDate:f,notes:""}}})}),{data:i,errors:l}=await a.json();if(l)throw Error(l[0].message);m.Am.success(`Booking successful! Total: Rp ${i.createBooking.totalPrice.toLocaleString()}`),t.push("/track")}catch(e){m.Am.error("Booking failed: "+e.message)}};if(p)return r.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:"Loading..."});if(h)return(0,r.jsxs)("div",{className:"min-h-screen bg-white flex items-center justify-center text-red-500",children:["Error: ",h]});if(!g)return r.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:"Store not found"});let _=N?N.price*v:0,k=g.images&&g.images.length>0?g.images:["bg-gray-200","bg-gray-300","bg-gray-400","bg-gray-500","bg-gray-600"],isUrl=e=>e.startsWith("http");return(0,r.jsxs)("main",{className:"min-h-screen bg-white",children:[r.jsx(a.Z,{}),(0,r.jsxs)("div",{className:"pt-28 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:g.name}),(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-800 font-medium",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(i.Z,{size:14,fill:"black"}),r.jsx("span",{children:g.rating||"New"}),r.jsx("span",{className:"mx-1",children:"\xb7"}),(0,r.jsxs)("span",{className:"underline cursor-pointer",children:[g.reviewCount||0," reviews"]}),r.jsx("span",{className:"mx-1",children:"\xb7"}),(0,r.jsxs)("span",{className:"flex items-center gap-1 text-gray-500",children:[r.jsx(l.Z,{size:14})," ",g.address]})]}),(0,r.jsxs)("div",{className:"flex gap-4",children:[(0,r.jsxs)("button",{className:"flex items-center gap-2 hover:bg-gray-100 px-2 py-1 rounded-md underline decoration-1",children:[r.jsx(n.Z,{size:16})," Share"]}),(0,r.jsxs)("button",{className:"flex items-center gap-2 hover:bg-gray-100 px-2 py-1 rounded-md underline decoration-1",children:[r.jsx(o.Z,{size:16})," Save"]})]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 grid-rows-2 gap-2 h-[400px] rounded-xl overflow-hidden mb-8",children:[r.jsx("div",{className:"col-span-2 row-span-2 relative bg-gray-200 flex items-center justify-center overflow-hidden",children:g.images&&g.images[0]&&isUrl(g.images[0])?r.jsx("img",{src:g.images[0],alt:"Main",className:"object-cover w-full h-full"}):r.jsx("div",{className:`w-full h-full ${k[0]}`})}),[1,2,3,4].map(e=>r.jsx("div",{className:"col-span-1 row-span-1 relative bg-gray-200 overflow-hidden",children:g.images&&g.images[e]&&isUrl(g.images[e])?r.jsx("img",{src:g.images[e],alt:`Image ${e}`,className:"object-cover w-full h-full"}):r.jsx("div",{className:`w-full h-full ${k[e]||"bg-gray-200"}`})},e))]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center border-b border-gray-200 pb-6 mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["Hosted by ",g.ownerId]}),(0,r.jsxs)("p",{className:"text-gray-500",children:["Joined in ",g.createdAt?new Date(parseInt(g.createdAt)).getFullYear():"2023"]})]}),r.jsx("div",{className:"w-12 h-12 bg-black rounded-full flex items-center justify-center text-white font-bold",children:g.ownerId?g.ownerId[0].toUpperCase():"O"})]}),r.jsx("div",{className:"mb-6 pb-6 border-b border-gray-200",children:r.jsx("p",{className:"text-gray-600 leading-relaxed",children:g.description})}),(0,r.jsxs)("div",{className:"mb-6",children:[r.jsx("h3",{className:"text-lg font-bold mb-4",children:"Services Offered"}),r.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:g.services&&g.services.map((e,s)=>(0,r.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("div",{className:"font-semibold",children:e.type.replace("_"," ")}),r.jsx("div",{className:"text-sm text-gray-500",children:e.label})]}),(0,r.jsxs)("div",{className:"font-bold",children:["Rp ",e.price.toLocaleString(),"/kg"]})]},s))})]})]}),r.jsx("div",{className:"relative",children:(0,r.jsxs)("div",{className:"sticky top-32 border border-gray-200 shadow-[0_6px_16px_rgba(0,0,0,0.12)] rounded-xl p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-baseline mb-6",children:[(0,r.jsxs)("span",{className:"text-2xl font-bold",children:["Rp ",N?.price.toLocaleString()||0]}),r.jsx("span",{className:"text-gray-500",children:" / kg"})]}),(0,r.jsxs)("div",{className:"border border-gray-400 rounded-lg mb-4",children:[(0,r.jsxs)("div",{className:"p-3 border-b border-gray-400",children:[r.jsx("label",{className:"block text-xs font-bold text-gray-800",children:"CHECK-IN"}),r.jsx("input",{type:"date",className:"w-full text-sm outline-none",onChange:e=>j(e.target.value)})]}),(0,r.jsxs)("div",{className:"p-3",children:[r.jsx("label",{className:"block text-xs font-bold text-gray-800",children:"WEIGHT (Kg)"}),r.jsx("input",{type:"number",min:"1",value:v,onChange:e=>y(parseInt(e.target.value)||0),className:"w-full text-sm outline-none"})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[r.jsx("label",{className:"block text-xs font-bold text-gray-800 mb-2",children:"SERVICE TYPE"}),r.jsx("select",{className:"w-full p-3 border border-gray-400 rounded-lg bg-white",onChange:e=>{let s=g.services.find(s=>s.type===e.target.value);s&&w(s)},children:g.services&&g.services.map(e=>(0,r.jsxs)("option",{value:e.type,children:[e.label||e.type," (",e.type,")"]},e.type))})]}),r.jsx("button",{onClick:handleBooking,className:"w-full bg-[#FF385C] hover:bg-[#E31C5F] text-white font-bold py-3.5 rounded-lg transition mb-4",children:"Book Order"}),(0,r.jsxs)("div",{className:"flex justify-between mt-4 font-bold text-lg pt-4 border-t border-gray-200",children:[r.jsx("span",{children:"Total"}),(0,r.jsxs)("span",{children:["Rp ",_.toLocaleString()]})]})]})})]})]})]})}},7573:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>i,default:()=>o});var r=t(5153);let a=(0,r.createProxy)(String.raw`C:\Users\alfan\OneDrive\Documents\Data Kuliah\Tasyakki\tugas_IAE\tubes\tubes_iae\frontend-app\src\app\store\[id]\page.tsx`),{__esModule:i,$$typeof:l}=a,n=a.default,o=n}};var s=require("../../../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[13,975,129,829,520,701],()=>__webpack_exec__(2218));module.exports=t})();