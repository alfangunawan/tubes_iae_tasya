(()=>{var e={};e.id=571,e.ids=[571],e.modules={55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},25528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},91877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},25319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},57310:e=>{"use strict";e.exports=require("url")},81270:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>d,routeModule:()=>g,tree:()=>c});var r=s(67096),a=s(16132),n=s(37284),l=s.n(n),i=s(32564),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let c=["",{children:["track",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,76621)),"C:\\Users\\alfan\\OneDrive\\Documents\\Data Kuliah\\Tasyakki\\tugas_IAE\\tubes\\tubes_iae\\frontend-app\\src\\app\\track\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,44847)),"C:\\Users\\alfan\\OneDrive\\Documents\\Data Kuliah\\Tasyakki\\tugas_IAE\\tubes\\tubes_iae\\frontend-app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\alfan\\OneDrive\\Documents\\Data Kuliah\\Tasyakki\\tugas_IAE\\tubes\\tubes_iae\\frontend-app\\src\\app\\track\\page.tsx"],x="/track/page",u={require:s,loadChunk:()=>Promise.resolve()},g=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/track/page",pathname:"/track",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},56302:(e,t,s)=>{Promise.resolve().then(s.bind(s,41846))},41846:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>TrackOrderPage});var r=s(30784),a=s(43701),n=s(15441),l=s(96253),i=s(66045),o=s(37004),c=s(34706),d=s(20644),x=s(9885),u=s(57114);let g={PENDING:{color:"text-yellow-700",bgColor:"bg-yellow-100",icon:n.Z,label:"Pending"},CONFIRMED:{color:"text-blue-700",bgColor:"bg-blue-100",icon:l.Z,label:"Confirmed"},PROCESSING:{color:"text-purple-700",bgColor:"bg-purple-100",icon:i.Z,label:"Processing"},READY:{color:"text-green-700",bgColor:"bg-green-100",icon:o.Z,label:"Ready for Pickup"},COMPLETED:{color:"text-gray-700",bgColor:"bg-gray-100",icon:l.Z,label:"Completed"},CANCELLED:{color:"text-red-700",bgColor:"bg-red-100",icon:c.Z,label:"Cancelled"}};function TrackOrderPage(){let e=(0,u.useRouter)(),[t,s]=(0,x.useState)([]),[l,c]=(0,x.useState)(!0),[m,p]=(0,x.useState)(""),[h,b]=(0,x.useState)(null);(0,x.useEffect)(()=>{let t=localStorage.getItem("token");if(!t){e.push("/login");return}try{let e=JSON.parse(atob(t.split(".")[1]));b(e.id),fetchBookings(e.id,t)}catch(e){console.error("Failed to decode token:",e),p("Invalid session. Please login again."),c(!1)}},[e]);let fetchBookings=async(e,t)=>{c(!0),p("");let r=`
            query MyBookings($userId: String!) {
                myBookings(userId: $userId) {
                    id
                    storeName
                    serviceType
                    serviceLabel
                    weight
                    totalPrice
                    checkInDate
                    status
                    createdAt
                    notes
                }
            }
        `;try{let a=await fetch("http://localhost:3000/graphql-booking",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({query:r,variables:{userId:e}})}),{data:n,errors:l}=await a.json();if(l)throw Error(l[0].message);s(n.myBookings||[])}catch(e){console.error("Failed to fetch bookings:",e),p(e.message)}finally{c(!1)}},formatDate=e=>{try{let t=new Date(e);return t.toLocaleDateString("id-ID",{weekday:"short",day:"numeric",month:"short",year:"numeric"})}catch{return e}},getStatusConfig=e=>g[e]||g.PENDING;return l?(0,r.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[r.jsx(a.Z,{}),r.jsx("div",{className:"pt-28 pb-12 px-4 sm:px-6 lg:px-8 max-w-5xl mx-auto",children:r.jsx("div",{className:"flex items-center justify-center py-20",children:r.jsx(i.Z,{className:"animate-spin text-[#FF385C]",size:40})})})]}):(0,r.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[r.jsx(a.Z,{}),(0,r.jsxs)("div",{className:"pt-28 pb-12 px-4 sm:px-6 lg:px-8 max-w-5xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Track Your Orders"}),r.jsx("p",{className:"text-gray-500 mt-1",children:"Monitor the status of your laundry orders"})]}),(0,r.jsxs)("button",{onClick:()=>{let e=localStorage.getItem("token");e&&h&&fetchBookings(h,e)},className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[r.jsx(d.Z,{size:18}),"Refresh"]})]}),m&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:r.jsx("p",{className:"text-red-700",children:m})}),!m&&0===t.length&&(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-12 text-center",children:[r.jsx(o.Z,{className:"mx-auto text-gray-300 mb-4",size:64}),r.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"No orders yet"}),r.jsx("p",{className:"text-gray-500 mb-6",children:"Start by booking a laundry service from one of our partners."}),r.jsx("button",{onClick:()=>e.push("/"),className:"bg-[#FF385C] hover:bg-[#E31C5F] text-white font-bold px-6 py-3 rounded-lg transition",children:"Browse Services"})]}),t.length>0&&r.jsx("div",{className:"space-y-4",children:t.map(e=>{let t=getStatusConfig(e.status),s=t.icon;return(0,r.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-md transition",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start gap-4",children:[r.jsx("div",{className:"flex-1",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[r.jsx("div",{className:"w-12 h-12 bg-[#FF385C] rounded-xl flex items-center justify-center text-white",children:r.jsx(o.Z,{size:24})}),(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-bold text-lg text-gray-900",children:e.storeName}),(0,r.jsxs)("p",{className:"text-gray-500 text-sm",children:[e.serviceLabel||e.serviceType," \xb7 ",e.weight," kg"]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-2 text-sm text-gray-400",children:[r.jsx(n.Z,{size:14}),(0,r.jsxs)("span",{children:["Check-in: ",formatDate(e.checkInDate)]})]})]})]})}),(0,r.jsxs)("div",{className:"flex flex-col items-end gap-2",children:[(0,r.jsxs)("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-semibold ${t.bgColor} ${t.color}`,children:[r.jsx(s,{size:14}),t.label]}),(0,r.jsxs)("span",{className:"text-xl font-bold text-gray-900",children:["Rp ",e.totalPrice.toLocaleString()]})]})]}),r.jsx("div",{className:"mt-6 pt-4 border-t border-gray-100",children:r.jsx("div",{className:"flex justify-between mb-2",children:["PENDING","CONFIRMED","PROCESSING","READY","COMPLETED"].map((t,s)=>{let a=["PENDING","CONFIRMED","PROCESSING","READY","COMPLETED"].indexOf(e.status),n=s<=a&&"CANCELLED"!==e.status,l="CANCELLED"===e.status;return(0,r.jsxs)("div",{className:"flex flex-col items-center flex-1",children:[r.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${l?"bg-red-100 text-red-600":n?"bg-[#FF385C] text-white":"bg-gray-200 text-gray-400"}`,children:s+1}),r.jsx("span",{className:`text-xs mt-1 text-center ${n&&!l?"text-gray-700":"text-gray-400"}`,children:t.charAt(0)+t.slice(1).toLowerCase()})]},t)})})}),(0,r.jsxs)("div",{className:"mt-4 flex justify-between text-xs text-gray-400",children:[(0,r.jsxs)("span",{children:["Order ID: ",e.id.slice(0,8),"..."]}),(0,r.jsxs)("span",{children:["Created: ",formatDate(e.createdAt)]})]})]},e.id)})})]})]})}},76621:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>o});var r=s(95153);let a=(0,r.createProxy)(String.raw`C:\Users\alfan\OneDrive\Documents\Data Kuliah\Tasyakki\tugas_IAE\tubes\tubes_iae\frontend-app\src\app\track\page.tsx`),{__esModule:n,$$typeof:l}=a,i=a.default,o=i}};var t=require("../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[922,125,322,719,551,287,74,520,701],()=>__webpack_exec__(81270));module.exports=s})();