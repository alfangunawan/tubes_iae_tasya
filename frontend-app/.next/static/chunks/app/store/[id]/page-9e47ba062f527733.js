(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[901],{5340:function(e,s,r){"use strict";r.d(s,{Z:function(){return a}});var t=r(5531);let a=(0,t.Z)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},7972:function(e,s,r){"use strict";r.d(s,{Z:function(){return a}});var t=r(5531);let a=(0,t.Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},3382:function(e,s,r){Promise.resolve().then(r.bind(r,9933))},9933:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return StoreDetailPage}});var t=r(7437),a=r(7924),l=r(5340),i=r(5531);let n=(0,i.Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),c=(0,i.Z)("share",[["path",{d:"M12 2v13",key:"1km8f5"}],["path",{d:"m16 6-4-4-4 4",key:"13yo43"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}]]),o=(0,i.Z)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);var d=r(2265),x=r(4033),m=r(1424);async function fetchStore(e){let s=localStorage.getItem("token"),r={"Content-Type":"application/json"};s&&(r.Authorization="Bearer ".concat(s));let t=await fetch("http://localhost:3000/graphql-store",{method:"POST",headers:r,body:JSON.stringify({query:"\n    query GetStore($id: ID!) {\n      store(id: $id) {\n        id\n        name\n        description\n        address\n        rating\n        reviewCount\n        images\n        ownerId\n        services {\n          type\n          price\n          label\n        }\n        createdAt\n      }\n    }\n  ",variables:{id:e}})}),{data:a,errors:l}=await t.json();if(l)throw Error(l[0].message);return a.store}function StoreDetailPage(e){let{params:s}=e,{id:r}=s,i=(0,x.useRouter)(),[h,g]=(0,d.useState)(null),[p,u]=(0,d.useState)(!0),[b,y]=(0,d.useState)(""),[f,v]=(0,d.useState)(""),[j,N]=(0,d.useState)(1),[k,w]=(0,d.useState)(null);(0,d.useEffect)(()=>{fetchStore(r).then(e=>{g(e),e.services&&e.services.length>0&&w(e.services[0])}).catch(e=>y(e.message)).finally(()=>u(!1))},[r]);let handleBooking=async()=>{let e;let s=localStorage.getItem("token");if(!s){m.Am.error("Please login to book"),i.push("/login");return}if(!k||!f){m.Am.warning("Please select a date and service");return}try{e=JSON.parse(atob(s.split(".")[1]))}catch(e){m.Am.error("Invalid session. Please login again."),i.push("/login");return}try{let r=await fetch("http://localhost:3000/graphql-booking",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({query:"\n            mutation CreateBooking($input: CreateBookingInput!) {\n                createBooking(input: $input) {\n                    id\n                    status\n                    totalPrice\n                }\n            }\n        ",variables:{input:{userId:e.id,userName:e.name,userEmail:e.email,storeId:h.id,storeName:h.name,serviceType:k.type,serviceLabel:k.label,weight:j,pricePerKg:k.price,checkInDate:f,notes:""}}})}),{data:t,errors:a}=await r.json();if(a)throw Error(a[0].message);m.Am.success("Booking successful! Total: Rp ".concat(t.createBooking.totalPrice.toLocaleString())),i.push("/track")}catch(e){m.Am.error("Booking failed: "+e.message)}};if(p)return(0,t.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:"Loading..."});if(b)return(0,t.jsxs)("div",{className:"min-h-screen bg-white flex items-center justify-center text-red-500",children:["Error: ",b]});if(!h)return(0,t.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:"Store not found"});let S=k?k.price*j:0,C=h.images&&h.images.length>0?h.images:["bg-gray-200","bg-gray-300","bg-gray-400","bg-gray-500","bg-gray-600"],isUrl=e=>e.startsWith("http");return(0,t.jsxs)("main",{className:"min-h-screen bg-white",children:[(0,t.jsx)(a.Z,{}),(0,t.jsxs)("div",{className:"pt-28 pb-12 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:h.name}),(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-800 font-medium",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.Z,{size:14,fill:"black"}),(0,t.jsx)("span",{children:h.rating||"New"}),(0,t.jsx)("span",{className:"mx-1",children:"\xb7"}),(0,t.jsxs)("span",{className:"underline cursor-pointer",children:[h.reviewCount||0," reviews"]}),(0,t.jsx)("span",{className:"mx-1",children:"\xb7"}),(0,t.jsxs)("span",{className:"flex items-center gap-1 text-gray-500",children:[(0,t.jsx)(n,{size:14})," ",h.address]})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("button",{className:"flex items-center gap-2 hover:bg-gray-100 px-2 py-1 rounded-md underline decoration-1",children:[(0,t.jsx)(c,{size:16})," Share"]}),(0,t.jsxs)("button",{className:"flex items-center gap-2 hover:bg-gray-100 px-2 py-1 rounded-md underline decoration-1",children:[(0,t.jsx)(o,{size:16})," Save"]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 grid-rows-2 gap-2 h-[400px] rounded-xl overflow-hidden mb-8",children:[(0,t.jsx)("div",{className:"col-span-2 row-span-2 relative bg-gray-200 flex items-center justify-center overflow-hidden",children:h.images&&h.images[0]&&isUrl(h.images[0])?(0,t.jsx)("img",{src:h.images[0],alt:"Main",className:"object-cover w-full h-full"}):(0,t.jsx)("div",{className:"w-full h-full ".concat(C[0])})}),[1,2,3,4].map(e=>(0,t.jsx)("div",{className:"col-span-1 row-span-1 relative bg-gray-200 overflow-hidden",children:h.images&&h.images[e]&&isUrl(h.images[e])?(0,t.jsx)("img",{src:h.images[e],alt:"Image ".concat(e),className:"object-cover w-full h-full"}):(0,t.jsx)("div",{className:"w-full h-full ".concat(C[e]||"bg-gray-200")})},e))]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-12",children:[(0,t.jsxs)("div",{className:"lg:col-span-2",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center border-b border-gray-200 pb-6 mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["Hosted by ",h.ownerId]}),(0,t.jsxs)("p",{className:"text-gray-500",children:["Joined in ",h.createdAt?new Date(parseInt(h.createdAt)).getFullYear():"2023"]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-black rounded-full flex items-center justify-center text-white font-bold",children:h.ownerId?h.ownerId[0].toUpperCase():"O"})]}),(0,t.jsx)("div",{className:"mb-6 pb-6 border-b border-gray-200",children:(0,t.jsx)("p",{className:"text-gray-600 leading-relaxed",children:h.description})}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Services Offered"}),(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:h.services&&h.services.map((e,s)=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"font-semibold",children:e.type.replace("_"," ")}),(0,t.jsx)("div",{className:"text-sm text-gray-500",children:e.label})]}),(0,t.jsxs)("div",{className:"font-bold",children:["Rp ",e.price.toLocaleString(),"/kg"]})]},s))})]})]}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("div",{className:"sticky top-32 border border-gray-200 shadow-[0_6px_16px_rgba(0,0,0,0.12)] rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-baseline mb-6",children:[(0,t.jsxs)("span",{className:"text-2xl font-bold",children:["Rp ",(null==k?void 0:k.price.toLocaleString())||0]}),(0,t.jsx)("span",{className:"text-gray-500",children:" / kg"})]}),(0,t.jsxs)("div",{className:"border border-gray-400 rounded-lg mb-4",children:[(0,t.jsxs)("div",{className:"p-3 border-b border-gray-400",children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-800",children:"CHECK-IN"}),(0,t.jsx)("input",{type:"date",className:"w-full text-sm outline-none",onChange:e=>v(e.target.value)})]}),(0,t.jsxs)("div",{className:"p-3",children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-800",children:"WEIGHT (Kg)"}),(0,t.jsx)("input",{type:"number",min:"1",value:j,onChange:e=>N(parseInt(e.target.value)||0),className:"w-full text-sm outline-none"})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-xs font-bold text-gray-800 mb-2",children:"SERVICE TYPE"}),(0,t.jsx)("select",{className:"w-full p-3 border border-gray-400 rounded-lg bg-white",onChange:e=>{let s=h.services.find(s=>s.type===e.target.value);s&&w(s)},children:h.services&&h.services.map(e=>(0,t.jsxs)("option",{value:e.type,children:[e.label||e.type," (",e.type,")"]},e.type))})]}),(0,t.jsx)("button",{onClick:handleBooking,className:"w-full bg-[#FF385C] hover:bg-[#E31C5F] text-white font-bold py-3.5 rounded-lg transition mb-4",children:"Book Order"}),(0,t.jsxs)("div",{className:"flex justify-between mt-4 font-bold text-lg pt-4 border-t border-gray-200",children:[(0,t.jsx)("span",{children:"Total"}),(0,t.jsxs)("span",{children:["Rp ",S.toLocaleString()]})]})]})})]})]})]})}},7924:function(e,s,r){"use strict";r.d(s,{Z:function(){return Navbar}});var t=r(7437),a=r(1396),l=r.n(a),i=r(5531);let n=(0,i.Z)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),c=(0,i.Z)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);var o=r(7972);let d=(0,i.Z)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var x=r(2265),m=r(4033);function Navbar(){let[e,s]=(0,x.useState)(null),[r,a]=(0,x.useState)(!0),i=(0,m.useRouter)();return(0,x.useEffect)(()=>{let fetchUser=async()=>{let e=localStorage.getItem("token");if(!e){a(!1);return}try{let r=await fetch("".concat("http://localhost:3000","/api/users/profile"),{headers:{Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();s(e)}else localStorage.removeItem("token")}catch(e){console.error("Failed to fetch user:",e)}finally{a(!1)}};fetchUser()},[]),(0,t.jsx)("nav",{className:"fixed top-0 w-full z-50 bg-white border-b border-gray-200",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center h-20",children:[(0,t.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,t.jsx)(l(),{href:"/",className:"flex items-center gap-2",children:(0,t.jsx)("span",{className:"text-[#FF385C] text-2xl font-bold",children:"Smart Laundry"})})}),(0,t.jsxs)("div",{className:"hidden md:flex space-x-8",children:[(0,t.jsx)(l(),{href:"/",className:"text-gray-500 hover:text-gray-900 px-3 py-2 text-sm font-medium",children:"Home"}),(0,t.jsx)("button",{className:"text-gray-900 border-b-2 border-black px-3 py-2 text-sm font-medium",children:"Services"}),(0,t.jsx)(l(),{href:"/track",className:"text-gray-500 hover:text-gray-900 px-3 py-2 text-sm font-medium",children:"Track Order"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"hidden md:block text-sm font-medium text-gray-900 hover:bg-gray-100 px-4 py-2 rounded-full cursor-pointer transition",children:"Join as Partner"}),(0,t.jsx)("div",{className:"p-2 hover:bg-gray-100 rounded-full cursor-pointer",children:(0,t.jsx)(n,{size:18})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 border border-gray-300 rounded-full p-1 pl-3 hover:shadow-md transition cursor-pointer relative group",children:[(0,t.jsx)(c,{size:18}),(0,t.jsx)("div",{className:"bg-gray-500 rounded-full p-1 text-white",children:(0,t.jsx)(o.Z,{size:18,fill:"white"})}),(0,t.jsx)("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white rounded-xl shadow-[0_6px_20px_rgba(0,0,0,0.12)] py-2 hidden group-hover:block border border-gray-100",children:r?(0,t.jsx)("div",{className:"px-4 py-2 text-sm text-gray-500",children:"Loading..."}):e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"px-4 py-3 hover:bg-gray-50 text-sm font-semibold text-gray-900 border-b border-gray-100",children:[(0,t.jsxs)("div",{children:["Hello, ",e.name]}),(0,t.jsx)("div",{className:"text-xs text-gray-400 font-normal",children:e.email})]}),(0,t.jsx)(l(),{href:"/profile",className:"block px-4 py-2 hover:bg-gray-50 text-sm text-gray-700",children:"My Profile"}),(0,t.jsx)(l(),{href:"/history",className:"block px-4 py-2 hover:bg-gray-50 text-sm text-gray-700",children:"Order History"}),(0,t.jsx)("div",{className:"border-t border-gray-200 my-2"}),(0,t.jsxs)("div",{onClick:()=>{localStorage.removeItem("token"),s(null),i.push("/"),i.refresh()},className:"block px-4 py-2 hover:bg-gray-50 text-sm text-red-600 cursor-pointer flex items-center gap-2",children:[(0,t.jsx)(d,{size:14})," Log out"]})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l(),{href:"/login",className:"block px-4 py-2 hover:bg-gray-50 text-sm font-semibold text-gray-900",children:"Log in"}),(0,t.jsx)(l(),{href:"/register",className:"block px-4 py-2 hover:bg-gray-50 text-sm text-gray-500",children:"Sign up"}),(0,t.jsx)("div",{className:"border-t border-gray-200 my-2"}),(0,t.jsx)(l(),{href:"/host",className:"block px-4 py-2 hover:bg-gray-50 text-sm text-gray-500",children:"Laundry your home"}),(0,t.jsx)("div",{className:"block px-4 py-2 hover:bg-gray-50 text-sm text-gray-500",children:"Help Center"})]})})]})]})]})})})}}},function(e){e.O(0,[933,424,971,472,744],function(){return e(e.s=3382)}),_N_E=e.O()}]);